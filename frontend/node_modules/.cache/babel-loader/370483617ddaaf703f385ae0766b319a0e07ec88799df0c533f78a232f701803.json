{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nexport const fetchPuzzles = createAsyncThunk('puzzle/fetchPuzzles', async () => {\n  const response = await fetch('/api/puzzles');\n  return response.json();\n});\nexport const fetchPuzzle = createAsyncThunk('puzzle/fetchPuzzle', async id => {\n  const response = await fetch(`/api/puzzles/${id}`);\n  return response.json();\n});\nexport const createPuzzle = createAsyncThunk('puzzle/createPuzzle', async puzzleData => {\n  const response = await fetch('/api/puzzles', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(puzzleData)\n  });\n  return response.json();\n});\nconst puzzleSlice = createSlice({\n  name: 'puzzle',\n  initialState: {\n    puzzles: [],\n    currentPuzzle: null,\n    optimisticMoves: {},\n    loading: false,\n    error: null\n  },\n  reducers: {\n    setCurrentPuzzle: (state, action) => {\n      state.currentPuzzle = action.payload;\n      state.optimisticMoves = {};\n    },\n    applyOptimisticMove: (state, action) => {\n      const {\n        row,\n        col,\n        value,\n        moveId\n      } = action.payload;\n      state.optimisticMoves[moveId] = {\n        row,\n        col,\n        value,\n        timestamp: Date.now()\n      };\n    },\n    confirmMove: (state, action) => {\n      const {\n        row,\n        col,\n        value\n      } = action.payload;\n      if (state.currentPuzzle) {\n        const grid = state.currentPuzzle.grid.split('');\n        grid[row * 4 + col] = value;\n        state.currentPuzzle.grid = grid.join('');\n      }\n      // Clear matching optimistic moves\n      Object.keys(state.optimisticMoves).forEach(moveId => {\n        const move = state.optimisticMoves[moveId];\n        if (move.row === row && move.col === col) {\n          delete state.optimisticMoves[moveId];\n        }\n      });\n    },\n    rollbackMove: (state, action) => {\n      const {\n        moveId\n      } = action.payload;\n      delete state.optimisticMoves[moveId];\n    },\n    puzzleSolved: (state, action) => {\n      if (state.currentPuzzle) {\n        state.currentPuzzle.solved = true;\n      }\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(fetchPuzzles.fulfilled, (state, action) => {\n      state.puzzles = action.payload;\n      state.loading = false;\n    }).addCase(fetchPuzzle.fulfilled, (state, action) => {\n      state.currentPuzzle = action.payload;\n      state.optimisticMoves = {};\n      state.loading = false;\n    }).addCase(createPuzzle.fulfilled, (state, action) => {\n      state.puzzles.push(action.payload);\n      state.loading = false;\n    }).addMatcher(action => action.type.endsWith('/pending'), state => {\n      state.loading = true;\n      state.error = null;\n    }).addMatcher(action => action.type.endsWith('/rejected'), (state, action) => {\n      state.loading = false;\n      state.error = action.error.message;\n    });\n  }\n});\nexport const {\n  setCurrentPuzzle,\n  applyOptimisticMove,\n  confirmMove,\n  rollbackMove,\n  puzzleSolved\n} = puzzleSlice.actions;\nexport default puzzleSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","fetchPuzzles","response","fetch","json","fetchPuzzle","id","createPuzzle","puzzleData","method","headers","body","JSON","stringify","puzzleSlice","name","initialState","puzzles","currentPuzzle","optimisticMoves","loading","error","reducers","setCurrentPuzzle","state","action","payload","applyOptimisticMove","row","col","value","moveId","timestamp","Date","now","confirmMove","grid","split","join","Object","keys","forEach","move","rollbackMove","puzzleSolved","solved","extraReducers","builder","addCase","fulfilled","push","addMatcher","type","endsWith","message","actions","reducer"],"sources":["C:/Users/aasth/OneDrive/Desktop/PROJECTS/PuzzlePlatform/frontend/src/store/puzzleSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\n\nexport const fetchPuzzles = createAsyncThunk(\n  'puzzle/fetchPuzzles',\n  async () => {\n    const response = await fetch('/api/puzzles');\n    return response.json();\n  }\n);\n\nexport const fetchPuzzle = createAsyncThunk(\n  'puzzle/fetchPuzzle',\n  async (id) => {\n    const response = await fetch(`/api/puzzles/${id}`);\n    return response.json();\n  }\n);\n\nexport const createPuzzle = createAsyncThunk(\n  'puzzle/createPuzzle',\n  async (puzzleData) => {\n    const response = await fetch('/api/puzzles', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(puzzleData),\n    });\n    return response.json();\n  }\n);\n\nconst puzzleSlice = createSlice({\n  name: 'puzzle',\n  initialState: {\n    puzzles: [],\n    currentPuzzle: null,\n    optimisticMoves: {},\n    loading: false,\n    error: null,\n  },\n  reducers: {\n    setCurrentPuzzle: (state, action) => {\n      state.currentPuzzle = action.payload;\n      state.optimisticMoves = {};\n    },\n    applyOptimisticMove: (state, action) => {\n      const { row, col, value, moveId } = action.payload;\n      state.optimisticMoves[moveId] = { row, col, value, timestamp: Date.now() };\n    },\n    confirmMove: (state, action) => {\n      const { row, col, value } = action.payload;\n      if (state.currentPuzzle) {\n        const grid = state.currentPuzzle.grid.split('');\n        grid[row * 4 + col] = value;\n        state.currentPuzzle.grid = grid.join('');\n      }\n      // Clear matching optimistic moves\n      Object.keys(state.optimisticMoves).forEach(moveId => {\n        const move = state.optimisticMoves[moveId];\n        if (move.row === row && move.col === col) {\n          delete state.optimisticMoves[moveId];\n        }\n      });\n    },\n    rollbackMove: (state, action) => {\n      const { moveId } = action.payload;\n      delete state.optimisticMoves[moveId];\n    },\n    puzzleSolved: (state, action) => {\n      if (state.currentPuzzle) {\n        state.currentPuzzle.solved = true;\n      }\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(fetchPuzzles.fulfilled, (state, action) => {\n        state.puzzles = action.payload;\n        state.loading = false;\n      })\n      .addCase(fetchPuzzle.fulfilled, (state, action) => {\n        state.currentPuzzle = action.payload;\n        state.optimisticMoves = {};\n        state.loading = false;\n      })\n      .addCase(createPuzzle.fulfilled, (state, action) => {\n        state.puzzles.push(action.payload);\n        state.loading = false;\n      })\n      .addMatcher(\n        (action) => action.type.endsWith('/pending'),\n        (state) => {\n          state.loading = true;\n          state.error = null;\n        }\n      )\n      .addMatcher(\n        (action) => action.type.endsWith('/rejected'),\n        (state, action) => {\n          state.loading = false;\n          state.error = action.error.message;\n        }\n      );\n  },\n});\n\nexport const { \n  setCurrentPuzzle, \n  applyOptimisticMove, \n  confirmMove, \n  rollbackMove, \n  puzzleSolved \n} = puzzleSlice.actions;\n\nexport default puzzleSlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}