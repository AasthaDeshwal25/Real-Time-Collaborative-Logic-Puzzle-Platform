{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\aasth\\\\OneDrive\\\\Desktop\\\\PROJECTS\\\\PuzzlePlatform\\\\frontend\\\\src\\\\components\\\\PuzzleGrid.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { applyOptimisticMove, rollbackMove } from '../store/puzzleSlice';\nimport { useWebSocket } from '../hooks/useWebSocket';\nimport './PuzzleGrid.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PuzzleGrid = ({\n  puzzleId\n}) => {\n  _s();\n  const dispatch = useDispatch();\n  const {\n    currentPuzzle,\n    optimisticMoves\n  } = useSelector(state => state.puzzle);\n  const {\n    sendMove,\n    connected\n  } = useWebSocket(puzzleId);\n  const [pendingMoves, setPendingMoves] = useState({});\n  const getCellValue = (row, col) => {\n    // First check if there's an optimistic move for this cell\n    for (const move of Object.values(optimisticMoves)) {\n      if (move.row === row && move.col === col) {\n        return move.value;\n      }\n    }\n\n    // Otherwise use the current puzzle state\n    if (currentPuzzle !== null && currentPuzzle !== void 0 && currentPuzzle.grid) {\n      return currentPuzzle.grid[row * 4 + col];\n    }\n    return '0';\n  };\n  const handleCellClick = (row, col) => {\n    if (!connected || currentPuzzle !== null && currentPuzzle !== void 0 && currentPuzzle.solved) return;\n    const moveId = `move_${row}_${col}_${Date.now()}`;\n    const currentValue = getCellValue(row, col);\n    const newValue = currentValue === '0' ? '1' : '0';\n\n    // Show the change immediately\n    dispatch(applyOptimisticMove({\n      row,\n      col,\n      value: newValue,\n      moveId\n    }));\n\n    // Track this move\n    setPendingMoves(prev => ({\n      ...prev,\n      [moveId]: true\n    }));\n\n    // Send to server\n    const moveData = {\n      puzzleId,\n      row,\n      col,\n      value: newValue\n    };\n    sendMove(moveData);\n\n    // Remove optimistic move after timeout if not confirmed\n    setTimeout(() => {\n      setPendingMoves(prev => {\n        if (prev[moveId]) {\n          dispatch(rollbackMove({\n            moveId\n          }));\n          const updated = {\n            ...prev\n          };\n          delete updated[moveId];\n          return updated;\n        }\n        return prev;\n      });\n    }, 4000);\n  };\n\n  // Clean up confirmed moves\n  useEffect(() => {\n    const confirmedMoves = Object.keys(optimisticMoves).filter(moveId => !pendingMoves[moveId]);\n    if (confirmedMoves.length > 0) {\n      setPendingMoves(prev => {\n        const updated = {\n          ...prev\n        };\n        confirmedMoves.forEach(moveId => delete updated[moveId]);\n        return updated;\n      });\n    }\n  }, [optimisticMoves, pendingMoves]);\n  if (!currentPuzzle) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading\",\n      children: \"Loading puzzle...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"puzzle-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: currentPuzzle.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `connection-status ${connected ? 'connected' : 'disconnected'}`,\n      children: connected ? 'ðŸŸ¢ Connected' : 'ðŸ”´ Disconnected'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"puzzle-grid\",\n      children: [0, 1, 2, 3].map(row => [0, 1, 2, 3].map(col => {\n        const cellValue = getCellValue(row, col);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `cell ${cellValue === '1' ? 'filled' : 'empty'}`,\n          onClick: () => handleCellClick(row, col),\n          children: cellValue\n        }, `cell-${row}-${col}`, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 15\n        }, this);\n      }))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"puzzle-info\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"How to play:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: currentPuzzle.rules\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this), currentPuzzle.solved && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"victory-banner\",\n      children: \"\\uD83C\\uDF89 Puzzle Complete! \\uD83C\\uDF89\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n};\n_s(PuzzleGrid, \"E5qMcKxrYeV7bnqGSpDt/KUlzTk=\", false, function () {\n  return [useDispatch, useSelector, useWebSocket];\n});\n_c = PuzzleGrid;\nexport default PuzzleGrid;\nvar _c;\n$RefreshReg$(_c, \"PuzzleGrid\");","map":{"version":3,"names":["React","useState","useEffect","useDispatch","useSelector","applyOptimisticMove","rollbackMove","useWebSocket","jsxDEV","_jsxDEV","PuzzleGrid","puzzleId","_s","dispatch","currentPuzzle","optimisticMoves","state","puzzle","sendMove","connected","pendingMoves","setPendingMoves","getCellValue","row","col","move","Object","values","value","grid","handleCellClick","solved","moveId","Date","now","currentValue","newValue","prev","moveData","setTimeout","updated","confirmedMoves","keys","filter","length","forEach","className","children","fileName","_jsxFileName","lineNumber","columnNumber","name","map","cellValue","onClick","rules","_c","$RefreshReg$"],"sources":["C:/Users/aasth/OneDrive/Desktop/PROJECTS/PuzzlePlatform/frontend/src/components/PuzzleGrid.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { applyOptimisticMove, rollbackMove } from '../store/puzzleSlice';\nimport { useWebSocket } from '../hooks/useWebSocket';\nimport './PuzzleGrid.css';\n\nconst PuzzleGrid = ({ puzzleId }) => {\n  const dispatch = useDispatch();\n  const { currentPuzzle, optimisticMoves } = useSelector(state => state.puzzle);\n  const { sendMove, connected } = useWebSocket(puzzleId);\n  const [pendingMoves, setPendingMoves] = useState({});\n\n  const getCellValue = (row, col) => {\n    // First check if there's an optimistic move for this cell\n    for (const move of Object.values(optimisticMoves)) {\n      if (move.row === row && move.col === col) {\n        return move.value;\n      }\n    }\n    \n    // Otherwise use the current puzzle state\n    if (currentPuzzle?.grid) {\n      return currentPuzzle.grid[row * 4 + col];\n    }\n    return '0';\n  };\n\n  const handleCellClick = (row, col) => {\n    if (!connected || currentPuzzle?.solved) return;\n    \n    const moveId = `move_${row}_${col}_${Date.now()}`;\n    const currentValue = getCellValue(row, col);\n    const newValue = currentValue === '0' ? '1' : '0';\n    \n    // Show the change immediately\n    dispatch(applyOptimisticMove({ row, col, value: newValue, moveId }));\n    \n    // Track this move\n    setPendingMoves(prev => ({ ...prev, [moveId]: true }));\n    \n    // Send to server\n    const moveData = { puzzleId, row, col, value: newValue };\n    sendMove(moveData);\n    \n    // Remove optimistic move after timeout if not confirmed\n    setTimeout(() => {\n      setPendingMoves(prev => {\n        if (prev[moveId]) {\n          dispatch(rollbackMove({ moveId }));\n          const updated = { ...prev };\n          delete updated[moveId];\n          return updated;\n        }\n        return prev;\n      });\n    }, 4000);\n  };\n\n  // Clean up confirmed moves\n  useEffect(() => {\n    const confirmedMoves = Object.keys(optimisticMoves).filter(\n      moveId => !pendingMoves[moveId]\n    );\n    \n    if (confirmedMoves.length > 0) {\n      setPendingMoves(prev => {\n        const updated = { ...prev };\n        confirmedMoves.forEach(moveId => delete updated[moveId]);\n        return updated;\n      });\n    }\n  }, [optimisticMoves, pendingMoves]);\n\n  if (!currentPuzzle) {\n    return <div className=\"loading\">Loading puzzle...</div>;\n  }\n\n  return (\n    <div className=\"puzzle-container\">\n      <h2>{currentPuzzle.name}</h2>\n      <div className={`connection-status ${connected ? 'connected' : 'disconnected'}`}>\n        {connected ? 'ðŸŸ¢ Connected' : 'ðŸ”´ Disconnected'}\n      </div>\n      \n      <div className=\"puzzle-grid\">\n        {[0, 1, 2, 3].map(row =>\n          [0, 1, 2, 3].map(col => {\n            const cellValue = getCellValue(row, col);\n            return (\n              <div\n                key={`cell-${row}-${col}`}\n                className={`cell ${cellValue === '1' ? 'filled' : 'empty'}`}\n                onClick={() => handleCellClick(row, col)}\n              >\n                {cellValue}\n              </div>\n            );\n          })\n        )}\n      </div>\n      \n      <div className=\"puzzle-info\">\n        <h3>How to play:</h3>\n        <p>{currentPuzzle.rules}</p>\n      </div>\n      \n      {currentPuzzle.solved && (\n        <div className=\"victory-banner\">\n          ðŸŽ‰ Puzzle Complete! ðŸŽ‰\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PuzzleGrid;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}