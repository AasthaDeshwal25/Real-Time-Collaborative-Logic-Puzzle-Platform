{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\aasth\\\\OneDrive\\\\Desktop\\\\PROJECTS\\\\PuzzlePlatform\\\\frontend\\\\src\\\\components\\\\PuzzleGrid.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { applyOptimisticMove, rollbackMove } from '../store/puzzleSlice';\nimport { useWebSocket } from '../hooks/useWebSocket';\nimport './PuzzleGrid.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PuzzleGrid = ({\n  puzzleId\n}) => {\n  _s();\n  const dispatch = useDispatch();\n  const {\n    currentPuzzle,\n    optimisticMoves\n  } = useSelector(state => state.puzzle);\n  const {\n    sendMove,\n    connected\n  } = useWebSocket(puzzleId);\n  const [pendingMoves, setPendingMoves] = useState(new Set());\n  const getCellValue = useCallback((row, col) => {\n    // Check optimistic moves first\n    const optimisticMove = Object.values(optimisticMoves).find(move => move.row === row && move.col === col);\n    if (optimisticMove) return optimisticMove.value;\n\n    // Fall back to current puzzle state\n    if (currentPuzzle !== null && currentPuzzle !== void 0 && currentPuzzle.grid) {\n      return currentPuzzle.grid[row * 4 + col];\n    }\n    return '0';\n  }, [currentPuzzle, optimisticMoves]);\n  const handleCellClick = useCallback((row, col) => {\n    if (!connected || currentPuzzle !== null && currentPuzzle !== void 0 && currentPuzzle.solved) return;\n    const moveId = `${row}-${col}-${Date.now()}`;\n    const currentValue = getCellValue(row, col);\n    const newValue = currentValue === '0' ? '1' : '0';\n\n    // Apply optimistic update\n    dispatch(applyOptimisticMove({\n      row,\n      col,\n      value: newValue,\n      moveId\n    }));\n    setPendingMoves(prev => new Set([...prev, moveId]));\n\n    // Send move to server\n    const move = {\n      puzzleId,\n      row,\n      col,\n      value: newValue\n    };\n    sendMove(move);\n\n    // Set timeout for rollback if no confirmation\n    setTimeout(() => {\n      setPendingMoves(prev => {\n        const newSet = new Set(prev);\n        if (newSet.has(moveId)) {\n          newSet.delete(moveId);\n          dispatch(rollbackMove({\n            moveId\n          }));\n        }\n        return newSet;\n      });\n    }, 5000);\n  }, [connected, currentPuzzle, getCellValue, dispatch, sendMove, puzzleId]);\n  if (!currentPuzzle) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading puzzle...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 30\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"puzzle-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: currentPuzzle.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"connection-status\",\n      children: [\"Status: \", connected ? 'Connected' : 'Disconnected']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"puzzle-grid\",\n      children: Array.from({\n        length: 4\n      }, (_, row) => Array.from({\n        length: 4\n      }, (_, col) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `cell ${getCellValue(row, col) === '1' ? 'filled' : 'empty'}`,\n        onClick: () => handleCellClick(row, col),\n        children: getCellValue(row, col)\n      }, `${row}-${col}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 13\n      }, this)))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"puzzle-rules\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Rules:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: currentPuzzle.rules\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), currentPuzzle.solved && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"solved-message\",\n      children: \"\\uD83C\\uDF89 Puzzle Solved! \\uD83C\\uDF89\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n};\n_s(PuzzleGrid, \"ELgnz5rlkeFRr8VvswFkcUcyN38=\", false, function () {\n  return [useDispatch, useSelector, useWebSocket];\n});\n_c = PuzzleGrid;\nexport default PuzzleGrid;\nvar _c;\n$RefreshReg$(_c, \"PuzzleGrid\");","map":{"version":3,"names":["React","useState","useCallback","useDispatch","useSelector","applyOptimisticMove","rollbackMove","useWebSocket","jsxDEV","_jsxDEV","PuzzleGrid","puzzleId","_s","dispatch","currentPuzzle","optimisticMoves","state","puzzle","sendMove","connected","pendingMoves","setPendingMoves","Set","getCellValue","row","col","optimisticMove","Object","values","find","move","value","grid","handleCellClick","solved","moveId","Date","now","currentValue","newValue","prev","setTimeout","newSet","has","delete","children","fileName","_jsxFileName","lineNumber","columnNumber","className","name","Array","from","length","_","onClick","rules","_c","$RefreshReg$"],"sources":["C:/Users/aasth/OneDrive/Desktop/PROJECTS/PuzzlePlatform/frontend/src/components/PuzzleGrid.js"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { applyOptimisticMove, rollbackMove } from '../store/puzzleSlice';\nimport { useWebSocket } from '../hooks/useWebSocket';\nimport './PuzzleGrid.css';\n\nconst PuzzleGrid = ({ puzzleId }) => {\n  const dispatch = useDispatch();\n  const { currentPuzzle, optimisticMoves } = useSelector(state => state.puzzle);\n  const { sendMove, connected } = useWebSocket(puzzleId);\n  const [pendingMoves, setPendingMoves] = useState(new Set());\n\n  const getCellValue = useCallback((row, col) => {\n    // Check optimistic moves first\n    const optimisticMove = Object.values(optimisticMoves).find(\n      move => move.row === row && move.col === col\n    );\n    if (optimisticMove) return optimisticMove.value;\n    \n    // Fall back to current puzzle state\n    if (currentPuzzle?.grid) {\n      return currentPuzzle.grid[row * 4 + col];\n    }\n    return '0';\n  }, [currentPuzzle, optimisticMoves]);\n\n  const handleCellClick = useCallback((row, col) => {\n    if (!connected || currentPuzzle?.solved) return;\n    \n    const moveId = `${row}-${col}-${Date.now()}`;\n    const currentValue = getCellValue(row, col);\n    const newValue = currentValue === '0' ? '1' : '0';\n    \n    // Apply optimistic update\n    dispatch(applyOptimisticMove({ row, col, value: newValue, moveId }));\n    setPendingMoves(prev => new Set([...prev, moveId]));\n    \n    // Send move to server\n    const move = { puzzleId, row, col, value: newValue };\n    sendMove(move);\n    \n    // Set timeout for rollback if no confirmation\n    setTimeout(() => {\n      setPendingMoves(prev => {\n        const newSet = new Set(prev);\n        if (newSet.has(moveId)) {\n          newSet.delete(moveId);\n          dispatch(rollbackMove({ moveId }));\n        }\n        return newSet;\n      });\n    }, 5000);\n  }, [connected, currentPuzzle, getCellValue, dispatch, sendMove, puzzleId]);\n\n  if (!currentPuzzle) return <div>Loading puzzle...</div>;\n\n  return (\n    <div className=\"puzzle-container\">\n      <h2>{currentPuzzle.name}</h2>\n      <div className=\"connection-status\">\n        Status: {connected ? 'Connected' : 'Disconnected'}\n      </div>\n      <div className=\"puzzle-grid\">\n        {Array.from({ length: 4 }, (_, row) =>\n          Array.from({ length: 4 }, (_, col) => (\n            <div\n              key={`${row}-${col}`}\n              className={`cell ${getCellValue(row, col) === '1' ? 'filled' : 'empty'}`}\n              onClick={() => handleCellClick(row, col)}\n            >\n              {getCellValue(row, col)}\n            </div>\n          ))\n        )}\n      </div>\n      <div className=\"puzzle-rules\">\n        <h3>Rules:</h3>\n        <p>{currentPuzzle.rules}</p>\n      </div>\n      {currentPuzzle.solved && (\n        <div className=\"solved-message\">\n          ðŸŽ‰ Puzzle Solved! ðŸŽ‰\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PuzzleGrid;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}