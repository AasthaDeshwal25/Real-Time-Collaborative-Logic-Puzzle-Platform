{"ast":null,"code":"import{createSlice,createAsyncThunk}from'@reduxjs/toolkit';export const fetchPuzzles=createAsyncThunk('puzzle/fetchPuzzles',async()=>{const response=await fetch('/api/puzzles');return response.json();});export const fetchPuzzle=createAsyncThunk('puzzle/fetchPuzzle',async id=>{const response=await fetch(\"/api/puzzles/\".concat(id));return response.json();});export const createPuzzle=createAsyncThunk('puzzle/createPuzzle',async puzzleData=>{const response=await fetch('/api/puzzles',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(puzzleData)});return response.json();});const puzzleSlice=createSlice({name:'puzzle',initialState:{puzzles:[],currentPuzzle:null,optimisticMoves:{},loading:false,error:null},reducers:{setCurrentPuzzle:(state,action)=>{state.currentPuzzle=action.payload;state.optimisticMoves={};},applyOptimisticMove:(state,action)=>{const{row,col,value,moveId}=action.payload;state.optimisticMoves[moveId]={row,col,value,timestamp:Date.now()};},confirmMove:(state,action)=>{const{row,col,value}=action.payload;if(state.currentPuzzle){const grid=state.currentPuzzle.grid.split('');grid[row*4+col]=value;state.currentPuzzle.grid=grid.join('');}// Clear matching optimistic moves\nObject.keys(state.optimisticMoves).forEach(moveId=>{const move=state.optimisticMoves[moveId];if(move.row===row&&move.col===col){delete state.optimisticMoves[moveId];}});},rollbackMove:(state,action)=>{const{moveId}=action.payload;delete state.optimisticMoves[moveId];},puzzleSolved:(state,action)=>{if(state.currentPuzzle){state.currentPuzzle.solved=true;}}},extraReducers:builder=>{builder.addCase(fetchPuzzles.fulfilled,(state,action)=>{state.puzzles=action.payload;state.loading=false;}).addCase(fetchPuzzle.fulfilled,(state,action)=>{state.currentPuzzle=action.payload;state.optimisticMoves={};state.loading=false;}).addCase(createPuzzle.fulfilled,(state,action)=>{state.puzzles.push(action.payload);state.loading=false;}).addMatcher(action=>action.type.endsWith('/pending'),state=>{state.loading=true;state.error=null;}).addMatcher(action=>action.type.endsWith('/rejected'),(state,action)=>{state.loading=false;state.error=action.error.message;});}});export const{setCurrentPuzzle,applyOptimisticMove,confirmMove,rollbackMove,puzzleSolved}=puzzleSlice.actions;export default puzzleSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","fetchPuzzles","response","fetch","json","fetchPuzzle","id","concat","createPuzzle","puzzleData","method","headers","body","JSON","stringify","puzzleSlice","name","initialState","puzzles","currentPuzzle","optimisticMoves","loading","error","reducers","setCurrentPuzzle","state","action","payload","applyOptimisticMove","row","col","value","moveId","timestamp","Date","now","confirmMove","grid","split","join","Object","keys","forEach","move","rollbackMove","puzzleSolved","solved","extraReducers","builder","addCase","fulfilled","push","addMatcher","type","endsWith","message","actions","reducer"],"sources":["C:/Users/aasth/OneDrive/Documents/GitHub/Real-Time-Collaborative-Logic-Puzzle-Platform/frontend/src/store/puzzleSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\n\nexport const fetchPuzzles = createAsyncThunk(\n  'puzzle/fetchPuzzles',\n  async () => {\n    const response = await fetch('/api/puzzles');\n    return response.json();\n  }\n);\n\nexport const fetchPuzzle = createAsyncThunk(\n  'puzzle/fetchPuzzle',\n  async (id) => {\n    const response = await fetch(`/api/puzzles/${id}`);\n    return response.json();\n  }\n);\n\nexport const createPuzzle = createAsyncThunk(\n  'puzzle/createPuzzle',\n  async (puzzleData) => {\n    const response = await fetch('/api/puzzles', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(puzzleData),\n    });\n    return response.json();\n  }\n);\n\nconst puzzleSlice = createSlice({\n  name: 'puzzle',\n  initialState: {\n    puzzles: [],\n    currentPuzzle: null,\n    optimisticMoves: {},\n    loading: false,\n    error: null,\n  },\n  reducers: {\n    setCurrentPuzzle: (state, action) => {\n      state.currentPuzzle = action.payload;\n      state.optimisticMoves = {};\n    },\n    applyOptimisticMove: (state, action) => {\n      const { row, col, value, moveId } = action.payload;\n      state.optimisticMoves[moveId] = { row, col, value, timestamp: Date.now() };\n    },\n    confirmMove: (state, action) => {\n      const { row, col, value } = action.payload;\n      if (state.currentPuzzle) {\n        const grid = state.currentPuzzle.grid.split('');\n        grid[row * 4 + col] = value;\n        state.currentPuzzle.grid = grid.join('');\n      }\n      // Clear matching optimistic moves\n      Object.keys(state.optimisticMoves).forEach(moveId => {\n        const move = state.optimisticMoves[moveId];\n        if (move.row === row && move.col === col) {\n          delete state.optimisticMoves[moveId];\n        }\n      });\n    },\n    rollbackMove: (state, action) => {\n      const { moveId } = action.payload;\n      delete state.optimisticMoves[moveId];\n    },\n    puzzleSolved: (state, action) => {\n      if (state.currentPuzzle) {\n        state.currentPuzzle.solved = true;\n      }\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(fetchPuzzles.fulfilled, (state, action) => {\n        state.puzzles = action.payload;\n        state.loading = false;\n      })\n      .addCase(fetchPuzzle.fulfilled, (state, action) => {\n        state.currentPuzzle = action.payload;\n        state.optimisticMoves = {};\n        state.loading = false;\n      })\n      .addCase(createPuzzle.fulfilled, (state, action) => {\n        state.puzzles.push(action.payload);\n        state.loading = false;\n      })\n      .addMatcher(\n        (action) => action.type.endsWith('/pending'),\n        (state) => {\n          state.loading = true;\n          state.error = null;\n        }\n      )\n      .addMatcher(\n        (action) => action.type.endsWith('/rejected'),\n        (state, action) => {\n          state.loading = false;\n          state.error = action.error.message;\n        }\n      );\n  },\n});\n\nexport const { \n  setCurrentPuzzle, \n  applyOptimisticMove, \n  confirmMove, \n  rollbackMove, \n  puzzleSolved \n} = puzzleSlice.actions;\n\nexport default puzzleSlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}